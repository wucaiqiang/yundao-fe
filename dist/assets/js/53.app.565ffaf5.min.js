webpackJsonp([53],{1647:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(0),c=o(u),f=n(42),p=n(84),d=o(p),m=n(358),g=o(m),h=n(357),v=o(h),y=n(1717),b=o(y),_=n(1889),w=o(_),E=n(1754),x=o(E),k=n(1778),O=o(k),C=n(1698),j=o(C),D=n(2011),S=o(D),U=n(33),P=o(U),L=n(2088),T=o(L),M=f.Form.Item,F=f.Select.Option,I=f.Radio.Group,R=(f.Checkbox.Group,f.Input.TextArea),z=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));V.call(n);var o=n.props,r=(o.location,o.match),l=r.params.id;return n.state={id:l,isEdit:!0,filters:{},visible:!0},n.formUtils=new v.default("Detail"),n}return r(t,e),s(t,[{key:"componentWillMount",value:function(){this.formUtils=this.props.formUtils||this.formUtils,this.formUtils.setForm(this.props.form),this.props.setForm&&this.props.setForm.call(this,this),this.news=new w.default,this.platform=new x.default,this.newsColumn=new O.default,this.loadData(),this.dictionary=new j.default,this.getDictionary()}},{key:"getDictionary",value:function(){var e=this;this.dictionary.gets("dic_article_status").then(function(t){if(t.success&&t.result){var n={};t.result.map(function(e){n[e.value]=e.selections}),e.setState({filters:n})}})}},{key:"formatData",value:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];"string"==typeof n&&(n=n.replace(/^\s*|\s*$/g,"")),n instanceof Date?n=(0,P.default)(n).format("YYYY-MM-DD HH:mm"):n instanceof P.default&&(n=(0,P.default)(n).format("YYYY-MM-DD HH:mm")),n instanceof Array&&(n=n.join(",")),n instanceof Object&&n._isAMomentObject&&(n=n.format("YYYY-MM-DD HH:mm")),e[t]=n}return e}},{key:"render",value:function(){var e=this,t={labelCol:{span:7},wrapperCol:{span:17}},n=this.props,o=n.data,a=void 0===o?{}:o,i=(n.mod,this.state),r=(i.activeKey,i.filters),s=i.platforms,u=this.formUtils.getFieldValue("coverUrl"),p=this.formUtils.getFieldValue("platformId");return s&&p&&(s.filter(function(e){return e.id==p})[0]&&s.filter(function(e){return e.id==p})[0].url||"www.xxx.com"),c.default.createElement(g.default,this.props,c.default.createElement("div",{className:T.default.page,ref:function(t){if(t){var n=t.parentNode.parentNode;e.affixContainer=n}}},c.default.createElement(f.Breadcrumb,{className:"page-breadcrumb"},c.default.createElement(f.Breadcrumb.Item,null,"内容配置"),c.default.createElement(f.Breadcrumb.Item,null,"文章内容配置"),c.default.createElement(f.Breadcrumb.Item,null,"新增文章")),c.default.createElement("div",{className:"page-content"},c.default.createElement(f.Form,null,c.default.createElement(M,l({label:"文章标题"},t),this.formUtils.getFieldDecorator("title",{initialValue:a.title?a.title:null,validateTrigger:["onChange","onBlur"],rules:[{required:!0,min:1,max:100,message:"请输入文章标题，长度1-100"}]})(c.default.createElement(f.Input,null))),c.default.createElement(M,l({label:"所属平台"},t),this.formUtils.getFieldDecorator("platformId",{initialValue:null,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"请选择预计打款日期"}]})(c.default.createElement(f.Select,{onChange:function(t){e.get_column(t)},disabled:!(!this.props.isEdit||!a.id),placeholder:"请选择平台"},this.state.platforms&&this.state.platforms.map(function(e){return c.default.createElement(F,{value:e.id,key:e.id},e.name)})))),c.default.createElement("div",{id:"columnContainer"},c.default.createElement(M,l({label:"所属栏目"},t),this.formUtils.getFieldDecorator("columnIds",{initialValue:a.columnIds,validateTrigger:["onChange","onBlur"]})(c.default.createElement(f.Select,{mode:"multiple",getPopupContainer:function(){return document.getElementById("columnContainer")},placeholder:"请选择所属栏目"},this.state.columns&&this.state.columns.map(function(e){return c.default.createElement(F,{value:e.id.toString(),key:e.id},e.name)}))))),c.default.createElement(M,l({label:"图片"},t),this.state.isEdit?this.formUtils.getFieldDecorator("coverUrl",{initialValue:[]})(c.default.createElement(b.default,{listType:"picture",accept:"jpg,jpeg,png",fileCount:1,fileSize:"30MB",fileList:u,onRemove:this.handUploadRemove,onChange:this.handleUploadChange},c.default.createElement(f.Button,null,c.default.createElement(f.Icon,{type:"cloud-upload-o"}),"上传"))):c.default.createElement("img",{src:a.coverUrl})),c.default.createElement(M,l({label:"SEO Title"},t),this.state.isEdit?this.formUtils.getFieldDecorator("seoTitle",{initialValue:a.seoTitle,validateTrigger:["onChange","onBlur"],rules:[{min:1,max:50,message:"请输入栏目Title,长度不超过50"}]})(c.default.createElement(f.Input,{placeholder:"请输入栏目Title"})):a.seoTitle),c.default.createElement(M,l({label:"SEO Keywords"},t),this.state.isEdit?this.formUtils.getFieldDecorator("seoKeywords",{initialValue:a.seoKeywords,validateTrigger:["onChange","onBlur"],rules:[{min:1,max:100,message:"请输入栏目Title,长度不超过100"}]})(c.default.createElement(f.Input,{placeholder:"请输入栏目Keywords"})):a.seoKeywords),c.default.createElement(M,l({label:"SEO Description"},t),this.state.isEdit?this.formUtils.getFieldDecorator("seoDescription",{initialValue:a.seoDescription,validateTrigger:["onChange","onBlur"],rules:[{min:1,max:200,message:"请输入栏目Title,长度不超过200"}]})(c.default.createElement(f.Input,{placeholder:"请输入栏目Description"})):a.seoDescription),c.default.createElement(M,l({label:"阅读数显示值"},t),this.state.isEdit?this.formUtils.getFieldDecorator("pageview",{initialValue:a.pageview,validateTrigger:["onChange","onBlur"]})(c.default.createElement(f.InputNumber,{min:0,precision:0,placeholder:"阅读数"})):a.pageview),c.default.createElement(M,l({label:"排序"},t),this.state.isEdit?this.formUtils.getFieldDecorator("sequence",{initialValue:a.sequence||0,validateTrigger:["onBlur"],rules:[{required:!0,message:"请输入排序"}]})(c.default.createElement(f.InputNumber,{precision:0,min:0,max:999999999,placeholder:"排序"})):a.sequence,"(数值越小越靠前)"),c.default.createElement(M,l({label:"发布时间"},t),this.state.isEdit?this.formUtils.getFieldDecorator("publishDate",{initialValue:(0,P.default)(),validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"请输入发布时间"}]})(c.default.createElement(f.DatePicker,{showTime:!0,format:"YYYY-MM-DD HH:mm",placeholder:"请输入发布时间"})):a.publishDate,"(默认立即发布，您可以修改发布时间用于定时发布)"),c.default.createElement(M,l({label:"文章导读"},t),this.state.isEdit?this.formUtils.getFieldDecorator("feature",{initialValue:a.articleDetail&&a.articleDetail.feature,validateTrigger:["onChange","onBlur"],rules:[{required:!0,min:1,max:500,message:"请输入文章导读,长度1-500"}]})(c.default.createElement(R,{className:T.default.feature,autosize:{minRows:2,maxRows:6},placeholder:"请输入文章导读"})):a.articleDetail&&a.articleDetail.feature),c.default.createElement(M,l({label:"文章正文"},t),this.state.isEdit?this.formUtils.getFieldDecorator("content",{initialValue:a.articleDetail&&a.articleDetail.content,validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"请填写文章正文"}]})(c.default.createElement(f.Input,{type:"hidden",placeholder:"请输入文章正文"})):a.articleDetail&&a.articleDetail.content,c.default.createElement(S.default,{ref:function(t){t&&(e.editor=t)},content:this.formUtils.getFieldValue("content"),callback:function(t){e.formUtils.setFieldsValue({content:t})}})),c.default.createElement(M,l({label:"状态"},t),this.state.isEdit?this.formUtils.getFieldDecorator("status",{initialValue:void 0!=a.status||null!=a.status?a.status.toString():"1",validateTrigger:["onChange","onBlur"],rules:[{required:!0,message:"请选择是否启用"}]})(c.default.createElement(I,{placeholder:"排序"},r.dic_article_status&&r.dic_article_status.map(function(e){return c.default.createElement(f.Radio,{key:e.value,value:e.value.toString()},e.label)}))):a.statusText),c.default.createElement(M,l({label:"文章来源"},t),this.state.isEdit?this.formUtils.getFieldDecorator("source",{initialValue:a.articleDetail&&a.articleDetail.source,validateTrigger:["onChange","onBlur"],rules:[{max:20,message:"请输入文章来源,长度不超过20"}]})(c.default.createElement(f.Input,{placeholder:"请输入文章来源"})):a.articleDetail&&a.articleDetail.source),c.default.createElement(M,l({label:"作者"},t),this.state.isEdit?this.formUtils.getFieldDecorator("author",{initialValue:a.articleDetail&&a.articleDetail.author,validateTrigger:["onChange","onBlur"],rules:[{max:20,message:"请输入作者，长度不超过20"}]})(c.default.createElement(f.Input,{placeholder:"请输入作者"})):a.articleDetail&&a.articleDetail.author),c.default.createElement("div",{className:T.default.operation},c.default.createElement(f.Button,{onClick:this.cancel,className:T.default.clear},"取消"),c.default.createElement(f.Button,{onClick:this.save,className:T.default.submit},"保存"))))))}}]),t}(d.default),V=function(){var e=this;this.loadData=function(){e.state.id;e.get_platform()},this.get_platform=function(){return e.platform.get_platform_web().then(function(t){e.setState({platforms:t.result});var n=t.result[0].id;e.formUtils.setFieldsValue({platformId:n}),e.get_column(n)})},this.get_column=function(t){return e.newsColumn.get_platform_column(t).then(function(t){e.setState({columns:t.result})})},this.cancel=function(){f.Modal.confirm({title:"确定取消新增文章？",okText:"确定",cancelText:"取消",onOk:function(){e.props.history.push("/cms/news/list")}})},this.save=function(t){t&&t.preventDefault(),e.formUtils.validateFields(function(t){if(!t){var n=e.formUtils.getFieldsValue();n.coverUrl&&n.coverUrl.length&&(n.coverUrl=n.coverUrl[0].url),n=e.formatData(n);(0,e.news.add)(n).then(function(t){t.success&&f.Modal.confirm({title:"新增文章成功.是否继续新增文章",okText:"继续新增",cancelText:"返回列表",onOk:function(){e.formUtils.resetFields(),e.editor.clean(),e.get_platform()},onCancel:function(){e.props.history.push("/cms/news/list")}})})}})}};z=f.Form.create()(z),t.default=z},1698:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(188),r=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){o(this,e)}return a(e,[{key:"gets",value:function(e){return r.default.get("/dictionary/gets",{codes:e})}}]),e}();t.default=l},1717:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),u=o(s),c=n(42),f=n(1),p=o(f),d=n(1718),m=o(d),g=n(1723),h=o(g),v=c.Upload.Dragger,y=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.beforeUpload=function(e,t){var o=n.props,a=o.accept,i=o.fileSize,r=n.accept.indexOf(e.type)>-1;r||c.message.error("只支持这些类型文件:"+a+"!");var l=e.size<n.fileSize;return l||c.message.error("文件大小不能大于"+i),r&&l},n.onRemove=function(e){n.setState(function(t){var o=t.fileList,a=o.indexOf(e),i=o.slice();return i.splice(a,1),n.props.onRemove&&n.props.onRemove.call(n,e,n),{fileList:i}})},n.handleProgress=function(){n.uploader.onProgress(function(e,t){})},n.msgList={},n.showUploadMsg=function(e,t){var o=n.state.msgList;o[e.uid]&&o[e.uid].show?(o[e.uid].content=t,n.setState({msgList:o}),c.message.destroy(),c.message.success(t)):(o[e.uid]={content:t,show:!0},n.setState({msgList:o},function(){c.message.info(o[e.uid].content,function(){o[e.uid].show=!1,n.setState({msgList:o})})}))},n.handleChange=function(e){var t=e.file,o=e.fileList;if("done"===t.status){n.showUploadMsg(t,"文件上传成功");var a=t.response;if(a.success){var i=o.filter(function(e){return e.uid===t.uid})[0],r=i.response;r&&r.result&&(i.url=r.result.url,t.url=r.result.url),n.props.onSave&&n.props.onSave.call(n,t,n),n.props.onChange&&n.props.onChange.call(n,o,n)}else switch(n.onRemove(t),a.code){case 9e5:case 900001:return void(location.href="/login");default:c.message.destroy(),c.message.error(a.message)}}else if("uploading"===t.status){console.log("uploading"),console.log(t);0==t.percent?n.showUploadMsg(t,"文件正在上传中..."):t.percent,n.props.onChange&&n.props.onChange.call(n,o,n)}else"removed"===t.status?n.props.onChange&&n.props.onChange.call(n,o,n):"error"===t.status&&(c.message.destroy(),c.message.error("文件上传失败!"),n.onRemove(t));n.props.onChange&&n.props.onChange.call(n,o,n),n.setState({fileList:o})},n.state={fileList:e.fileList||[],msgList:{}},n}return r(t,e),l(t,[{key:"componentWillMount",value:function(){this.Mime=new m.default,this.fileSize=this.parseFileSize(this.props.fileSize),this.accept=this.Mime.extList2mimes(this.props.accept).join(",")}},{key:"componentWillReceiveProps",value:function(e){"fileList"in e&&this.setState({fileList:e.fileList||[]})}},{key:"clear",value:function(){var e=this;setTimeout(function(){e.setState({fileList:[]})})}},{key:"parseFileSize",value:function(e){if("string"!=typeof e)return e;var t,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],n.hasOwnProperty(t)&&(e*=n[t]),e}},{key:"handleEdit",value:function(e){var t=void 0;this.props.onClickMask&&(t=this.props.onClickMask.call(this,e)),(!1===this.props.editable||t)&&e.stopPropagation()}},{key:"render",value:function(){var e=this,t=this.props.fileCount,n=!0,o=this.state.fileList,a=u.default.createElement("div",null,u.default.createElement(c.Icon,{type:"plus"}),u.default.createElement("div",{className:"ant-upload-text"},"Upload"));o?o.length>=t&&(n=!1):n=!0,t<=0&&(n=!1);var i=this.props,r=i.dragger,l=i.action,s=i.showUploadList,f=i.multiple,p=i.onRemove,d=i.children,m=r?v:c.Upload;return u.default.createElement("div",{className:"upload-card"+(n?"":" upload-card-uploaded")},u.default.createElement(m,{ref:function(t){return e.uploader=t},uploader:"uploader",name:"file",action:l,showUploadList:s,multiple:f,onRemove:p,onChange:this.handleChange,beforeUpload:this.beforeUpload,withCredentials:!0,accept:this.accept+","+this.props.accept.split(",").map(function(e){return"."+e}).join(","),fileList:this.state.fileList},n?d||a:null))}}],[{key:"Video",get:function(){return u.default.createElement(h.default,null)}}]),t}(u.default.Component);y.propTypes={multiple:p.default.bool,fileCount:p.default.number,action:p.default.string.isRequired},y.defaultProps={multiple:!1,accept:"doc,docx,xls,xlsx,pdf,png,jpg,jpeg,gif,txt",fileCount:10,fileSize:"30MB",action:"/api/file/upload"},t.default=y},1718:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(){function e(){o(this,e),this.mimes={},this.extensions={},this.addMimeType(e.mimeData)}return a(e,[{key:"addMimeType",value:function(e){var t,n,o,a=e.split(/,/);for(t=0;t<a.length;t+=2){for(o=a[t+1].split(/ /),n=0;n<o.length;n++)this.mimes[o[n]]=a[t];this.extensions[a[t]]=o}}},{key:"extList2mimes",value:function(e,t){var n,o,a=this,i=e.split(/\s*,\s*/),r=[];for(n=0;n<i.length;n++){if("*"===i[n])return[];if(o=a.mimes[i[n]])-1===r.indexOf(o)&&r.push(o);else{if(!t||!/^\w+$/.test(i[n]))return[];r.push("."+i[n])}}return r}},{key:"mimes2exts",value:function(e){var t=this,n=[];return e.forEach(function(e){if("*"===e)return n=[],!1;var o=e.match(/^(\w+)\/(\*|\w+)$/);o&&("*"===o[2]?t.extensions.forEach(function(e,a){new RegExp("^"+o[1]+"/").test(a)&&[].push.apply(n,t.extensions[a])}):t.extensions[e]&&[].push.apply(n,t.extensions[e]))}),n}},{key:"mimes2extList",value:function(e){var t=[];return"string"==typeof e&&(e=e.trim().split(/\s*,\s*/)),t=this.mimes2exts(e),t.length?t.join(","):"*"}},{key:"getFileExtension",value:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""}},{key:"getFileMime",value:function(e){return this.mimes[this.getFileExtension(e)]||""}}]),e}();i.mimeData="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mp4v mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-f4v,f4v,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,application/vnd.rn-realmedia-vbr,rmvb,video/x-ms-asf,asf,video/x-ms-asf,asx,video/x-ms-wm,wm,video/x-pn-realvideo,ra,application/vnd.rn-realmedia,rm,video/x-pn-realvideo,ram,video/dvd,vob,application/octet-stream,dat,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",t.default=i},1722:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(188),r=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){o(this,e)}return a(e,[{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fileId:fileId};return r.default.post("/video/add",e)}},{key:"get",value:function(e){return r.default.get("/video/get",{id:e})}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:id,name:name};return r.default.post("/video/update",e)}},{key:"getSignature",value:function(){return r.default.get("/video/get_upload_signature")}},{key:"delete",value:function(e){return r.default.post("/video/delete",{ids:e})}},{key:"transcode",value:function(e){return r.default.post("/video/convert",{ids:e})}},{key:"gets_by_name",value:function(e){return r.default.get("/video/gets_by_name",{name:e})}}]),e}();t.default=l},1723:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(0),c=o(u),f=n(42),p=n(1),d=o(p),m=n(1718),g=o(m),h=n(1722),v=o(h),y=f.Upload.Dragger,b=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));_.call(n),n.mime=new g.default;var o=n.mime.extList2mimes(n.props.accept,!0);return n.state={fileList:[],msgList:{},accept:o},console.log("accept",o),n}return l(t,e),s(t,[{key:"componentWillMount",value:function(){"infinite"!==this.props.fileSize&&(this.fileSize=this.parseFileSize(this.props.fileSize))}},{key:"componentWillReceiveProps",value:function(e){"fileList"in e&&this.setState({fileList:e.fileList||[]})}},{key:"clear",value:function(){var e=this;setTimeout(function(){e.setState({fileList:[]})})}},{key:"parseFileSize",value:function(e){if("string"!=typeof e)return e;var t,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],n.hasOwnProperty(t)&&(e*=n[t]),e}},{key:"render",value:function(){var e=this,t=this.props.fileCount,n=!0,o=this.state.fileList,i=c.default.createElement("div",null,c.default.createElement(f.Icon,{type:"plus"}),c.default.createElement("div",{className:"ant-upload-text"},"Upload"));o?o.length>=t&&(n=!1):n=!0,t<=0&&(n=!1);var r=this.props,l=r.dragger,s=r.action,u=r.showUploadList,p=r.multiple,d=r.onRemove,m=r.children,g=(a(r,["dragger","action","showUploadList","multiple","onRemove","children"]),l?y:f.Upload);return c.default.createElement("div",{className:"upload-card"+(n?"":" upload-card-uploaded")},c.default.createElement(g,{ref:function(t){return e.uploader=t},uploader:"uploader",name:"file",action:s,showUploadList:u,multiple:p,onRemove:d,beforeUpload:this.beforeUpload,withCredentials:!0,customRequest:this.customRequest,fileList:this.state.fileList},n?m||i:null))}}]),t}(u.Component);b.propTypes={multiple:d.default.bool,fileCount:d.default.number},b.defaultProps={multiple:!1,accept:"wmv,wm,asf,asx,rm,rmvb,ra,ram,mpg,mpeg,mpe,vob,dat,mov,3gp,mp4,mp4v,m4v,mkv,avi,flv,f4v",fileCount:10,fileSize:"infinite"};var _=function(){var e=this;this.beforeUpload=function(t,n){var o=e.props,a=(o.accept,o.fileSize),i=t.name.split(".")[t.name.split(".").length-1],r=e.state.accept.indexOf(t.type)>-1||e.props.accept.indexOf(i)>-1;r||f.message.error("不支持的文件格式");var l=!0;return e.fileSize&&((l=t.size<e.fileSize)||f.message.error("文件大小不能大于"+a)),r&&l},this.onRemove=function(t){e.setState(function(n){var o=n.fileList,a=o.indexOf(t),i=o.slice();return i.splice(a,1),e.props.onRemove&&e.props.onRemove.call(e,t,e),{fileList:i}})},this.handleProgress=function(){e.uploader.onProgress(function(e,t){console.log(e.state,e.percent)})},this.msgList={},this.showUploadMsg=function(t,n){var o=e.state.msgList;o[t.uid]&&o[t.uid].show?(o[t.uid].content=n,e.setState({msgList:o}),f.message.destroy(),f.message.success(n)):(o[t.uid]={content:n,show:!0},e.setState({msgList:o},function(){f.message.info(o[t.uid].content,function(){o[t.uid].show=!1,e.setState({msgList:o})})}))},this.start=function(t,o){var a=window,i=a.APP,r=t.uid,l=function(){return o?i.state[o]||[]:i.state.uploadVideoList||[]},s=function(e){var t={};o?t[o]=e:t.uploadVideoList=e,i.setState(t)},u=e,c=new v.default;n.e(0).then(function(){var e=n(728);window.$=e,window.jQuery=e,window.qcVideo.ugcUploader.start({videoFile:t,getSignature:function(e){c.getSignature().then(function(t){if(t&&t.success&&t.result)e(t.result);else{var n=l(),o=n?n.map(function(e){return e.uid==r&&(e.status="error"),e}):[];s(o),u.props.onError&&u.props.onError(t)}})},success:function(e){console.log("success")},error:function(e){console.log("上传失败:",e),console.log("上传失败的文件类型："+e.type),console.log("上传失败的原因："+e.msg),e.status="error";var t=l(),n=t?t.map(function(e){return e.uid==r&&(e.status="error"),e}):[];u.props.onError&&u.props.onError(e),s(n)},progress:function(e){console.log("上传进度:",e),console.log("上传进度的文件类型："+e.type),console.log("上传进度的文件名称："+e.name),console.log("上传进度："+e.shacurr);var t=l(),n=t?t.map(function(t){return t.uid==r&&(t.status="uploading",t.percent=100*e.shacurr||0),t}):[];u.props.onProgress&&u.props.onProgress(e),s(n)},finish:function(e){console.log("finish");var t=l();console.log("uploadVideoList",t),console.log("uid",r);var n=t?t.filter(function(e){return e.uid==r})[0]:{};if(n.fileId=e.fileId,u.props.onSave)return void u.props.onSave(n);c.add(n).then(function(e){var t="done";e.success||(t="error"),"done"==t&&f.notification.success({message:"视频上传成功",description:n.name+",该视频已成功上传"});var o=l(),a=o?o.map(function(e){return e.uid==r&&(e.status=t),e}):[];s(a)}),console.log("上传成功:",e),console.log("上传成功的文件类型："+e.type)}})}.bind(null,n)).catch(n.oe)},this.customRequest=function(t){var n=(t.onProgress,t.onError,t.onSuccess,t.data,t.filename,t.file);t.withCredentials,t.action,t.headers;console.log("file",n),e.props.onAdd&&e.props.onAdd(n)}};t.default=b},1754:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(188),r=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){o(this,e)}return a(e,[{key:"get_platform",value:function(){return r.default.get("/platform/get_all")}},{key:"get_platform_web",value:function(){return r.default.get("/platform/get_web")}},{key:"get_platform_roadshow",value:function(){return r.default.get("/platform/get_roadshow_platform")}},{key:"get_roadshow_platform",value:function(){return r.default.get("/platform/get_roadshow_platform")}},{key:"get_position_by_platform",value:function(e){return r.default.get("/platform/get_position_by_platform",{platformId:e})}}]),e}();t.default=l},1778:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(188),r=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){o(this,e)}return a(e,[{key:"add",value:function(e){return r.default.post("/cms/article/column/add",e)}},{key:"delete",value:function(e){return r.default.post("/cms/article/column/delete",{ids:e})}},{key:"get",value:function(e){return r.default.get("/cms/article/column/get",{id:e})}},{key:"update",value:function(e){return r.default.post("/cms/article/column/update",e)}},{key:"get_page",value:function(){return r.default.get("/cms/article/column/get_page")}},{key:"get_platform_column",value:function(e){return r.default.get("/cms/article/column/get_select_option",{platformId:e})}}]),e}();t.default=l},1889:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(188),r=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){o(this,e)}return a(e,[{key:"add",value:function(e){return r.default.post("/cms/article/add",e)}},{key:"delete",value:function(e){return r.default.post("/cms/article/delete",{ids:e})}},{key:"get",value:function(e){return r.default.get("/cms/article/get",{id:e})}},{key:"update",value:function(e){return r.default.post("/cms/article/update",e)}},{key:"get_page",value:function(){return r.default.get("/cms/article/get_page")}}]),e}();t.default=l},1957:function(e,t,n){t=e.exports=n(94)(void 0),t.push([e.i,".page___1zH8r .ant-form-item-label{text-align:left;width:200px}.page___1zH8r .page-content{padding:30px}.page___1zH8r .operation___1AVE1{display:flex;align-items:center}.page___1zH8r .operation___1AVE1 .clear___3ThMB{border:none;height:40px;display:inline-flex;align-items:center;justify-content:center;margin-right:10px;border:1px solid #465174;margin-left:10px}.page___1zH8r .operation___1AVE1 .submit___2dY4C{background-color:#465174;border-radius:2px;border-color:#465174;height:40px;display:inline-flex;align-items:center;justify-content:center;color:#fff;font-family:PingFangSC-Medium,sans-serif;font-size:16px;color:#f2d5aa}.page___1zH8r .feature___3v8ok{padding:12px 7px}",""]),t.locals={page:"page___1zH8r",operation:"operation___1AVE1",clear:"clear___3ThMB",submit:"submit___2dY4C",feature:"feature___3v8ok"}},1984:function(e,t){function n(e,t){for(var n in t)e.setAttribute(n,t[n])}function o(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function a(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}e.exports=function(e,t,i){var r=document.head||document.getElementsByTagName("head")[0],l=document.createElement("script");"function"==typeof t&&(i=t,t={}),t=t||{},i=i||function(){},l.type=t.type||"text/javascript",l.charset=t.charset||"utf8",l.async=!("async"in t)||!!t.async,l.src=e,t.attrs&&n(l,t.attrs),t.text&&(l.text=""+t.text),("onload"in l?o:a)(l,i),l.onload||o(l,i),r.appendChild(l)}},1985:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),u=o(s),c=n(1),f=o(c),p=n(12),d=o(p),m=n(1984),g=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onLoad=n.onLoad.bind(n),n.state={isScriptLoaded:n.props.isScriptLoaded,config:n.props.config},n}return r(t,e),l(t,[{key:"componentDidMount",value:function(){this.props.isScriptLoaded?this.onLoad():m(this.props.scriptUrl,this.onLoad)}},{key:"onLoad",value:function(){if(this.setState({isScriptLoaded:!0}),!window.CKEDITOR)return void console.error("CKEditor not found");this.editorInstance=window.CKEDITOR.appendTo(d.default.findDOMNode(this),this.state.config,this.props.content);for(var e in this.props.events){var t=this.props.events[e];this.editorInstance.on(e,t)}}},{key:"render",value:function(){return u.default.createElement("div",{className:this.props.activeClass})}}]),t}(u.default.Component);g.defaultProps={content:"",config:{},isScriptLoaded:!1,scriptUrl:"https://cdn.ckeditor.com/4.6.2/standard/ckeditor.js",activeClass:"",events:{}},g.propTypes={content:f.default.any,config:f.default.object,isScriptLoaded:f.default.bool,scriptUrl:f.default.string,activeClass:f.default.string,events:f.default.object},t.default=g},1986:function(e,t,n){"use strict";e.exports=n(1985)},2011:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),u=o(s),c=n(84),f=o(c),p=n(1986),d=o(p),m=function(e){function t(e){a(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){var t=n.props.callback,o=e.editor.getData();n.setState({content:o}),t&&t(o)},n.onBlur=function(e){},n.clean=function(){var e=CKEDITOR,t=e.instances;for(var n in t)try{t[n].setData("")}catch(e){console.log("error",e)}},n.afterPaste=function(e){},n.state={content:e.content},n}return r(t,e),l(t,[{key:"render",value:function(){var e=null;return this.props.content&&(e=this.props.content),u.default.createElement(d.default,{activeClass:"p10",content:e,config:{language:"zh-cn",filebrowserUploadUrl:"/api/file/upload_callback"},events:{blur:this.onBlur,afterPaste:this.afterPaste,change:this.onChange}})}}]),t}(f.default);t.default=m},2088:function(e,t,n){var o=n(1957);"string"==typeof o&&(o=[[e.i,o,""]]);var a={};a.transform=void 0;n(93)(o,a);o.locals&&(e.exports=o.locals)}});